%--------------------- PRESENTATION SECTIONS
\usepackage{titlesec}
\setcounter{secnumdepth}{3}
\makeatletter

% couleurs section
\definecolor{section@title@color}{cmyk}{1,0.2,0.3,0.1}
\definecolor{subsection@title@color}{cmyk}{0,0.6,0.9,0}
\definecolor{subsubsection@title@color}{cmyk}{1,0.2,0.3,0.1}
\definecolor{shadow@color}{cmyk}{.07,0,0,0.49}

% fontes section
\def\sectiontitle@font{\fontfamily{ppl}\fontseries{bx}\selectfont}
%\def\subsectiontitle@font{\fontfamily{ppl}\fontseries{bx}\selectfont}
%\def\subsubsectiontitle@font{\fontfamily{ppl}\fontseries{bx}\selectfont}

% Décalages numéro de sections / titres des sections
\newlength\decalnumsec
\newlength\decalnumsubsec
\newlength\decalnumsubsubsec
\setlength{\decalnumsec}{-0.5em}
\setlength{\decalnumsubsec}{-0.5em}
\setlength{\decalnumsubsubsec}{-0.5em}
\newlength\decalxtitlesec
\newlength\decalxtitlesubsec
\newlength\decalxtitlesubsubsec
\setlength{\decalxtitlesec}{-2.45em}
\setlength{\decalxtitlesubsec}{-1em}
\setlength{\decalxtitlesubsubsec}{0.45em}

% Espace entre le numéro de section et le titre
\newlength\spacetitlesec
\newlength\spacetitlesubsec
\newlength\spacetitlesubsubsec
\setlength{\spacetitlesec}{0.2em}
\setlength{\spacetitlesubsec}{0.2em}
\setlength{\spacetitlesubsubsec}{0.2em}

%%%%%%%%%%%%% Titre de section

\renewcommand{\thesection}{\Roman{section}}
\titleformat{\section}[block]
{%
	\hspace*{\decalxtitlesec}
	\bfseries\large
	\color{section@title@color}
	\sectiontitle@font
}
{
\raisebox{\decalnumsec}
{%
\begin{tikzpicture}
\node (numsec) {\sectiontitle@font\thesection};
\fill[rounded corners=2pt,fill=shadow@color] ($(numsec.north west)+(2pt,-2pt)$) -- ($(numsec.north east)+(1mm,0mm)+(2pt,-2pt)$) -- ($(numsec.south east)+(2pt,-2pt)$) -- ($(numsec.south west)+(-1mm,0)+(2pt,-2pt)$) -- cycle;
\fill[rounded corners=2pt,fill=section@title@color] (numsec.north west) -- ($(numsec.north east)+(1mm,0mm)$) -- (numsec.south east) -- ($(numsec.south west)+(-1mm,0)$) -- cycle;
\node[white] at (numsec) {\sectiontitle@font\thesection};
\end{tikzpicture}
}
}
{\spacetitlesec}
{}

%%%%%%%%%%%%% Titre de subsection

\renewcommand{\thesubsection}{\Alph{subsection}}
\titleformat{\subsection}[block]
{%
	\hspace*{\decalxtitlesubsec}
	\bfseries
	\color{subsection@title@color}
	\sectiontitle@font
}
{
	\raisebox{\decalnumsubsec}
	{%
	\begin{tikzpicture}
	\node (numsubsec) {\sectiontitle@font\thesubsection};
	\fill[rounded corners=2pt,fill=shadow@color] ($(numsubsec.north west)+(2pt,-2pt)$) -- ($(numsubsec.north east)+(1mm,0mm)+(2pt,-2pt)$) -- ($(numsubsec.south east)+(2pt,-2pt)$) -- ($(numsubsec.south west)+(-1mm,0)+(2pt,-2pt)$) -- cycle;
	\fill[rounded corners=2pt,fill=subsection@title@color] (numsubsec.north west) -- ($(numsubsec.north east)+(1mm,0mm)$) -- (numsubsec.south east) -- ($(numsubsec.south west)+(-1mm,0)$) -- cycle;
	\node[white] at (numsubsec) {\sectiontitle@font\thesubsection};
	\end{tikzpicture}
	}
}
{%
	\spacetitlesubsec
}
{} 

%%%%%%%%%%%%% Titre de subsubsection

\renewcommand{\thesubsubsection}{\arabic{subsubsection}}
\titleformat{\subsubsection}[block]
{%
	\hspace*{\decalxtitlesubsubsec}
	\bfseries
	\color{section@title@color}
	\sectiontitle@font
}
{
	\raisebox{\decalnumsubsubsec}
	{%
	\begin{tikzpicture}
	\node (numsubsubsec) {\sectiontitle@font\thesubsubsection};
	\fill[rounded corners=2pt,fill=shadow@color] ($(numsubsubsec.north west)+(2pt,-2pt)$) -- ($(numsubsubsec.north east)+(1mm,0mm)+(2pt,-2pt)$) -- ($(numsubsubsec.south east)+(2pt,-2pt)$) -- ($(numsubsubsec.south west)+(-1mm,0)+(2pt,-2pt)$) -- cycle;
	\fill[rounded corners=2pt,fill=subsubsection@title@color] (numsubsubsec.north west) -- ($(numsubsubsec.north east)+(1mm,0mm)$) -- (numsubsubsec.south east) -- ($(numsubsubsec.south west)+(-1mm,0)$) -- cycle;
	\node[white] at (numsubsubsec) {\sectiontitle@font\thesubsubsection};
	\end{tikzpicture}
	}
}
{\spacetitlesubsubsec}
{} 

\makeatother
